<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>POS System - Mypage</title>

    <!-- ê³µí†µ ë¦¬ì†ŒìŠ¤ -->
    <link rel="stylesheet" href="css/common.css" />
    <link rel="stylesheet" href="css/mypage.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      as="style"
      crossorigin
      href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard-dynamic-subset.min.css"
    />

    <!-- Firebase -->
    <script type="module" src="js/components/firebase-config.js"></script>
    <!-- Page JS -->
    <script type="module" src="js/mypage.js" defer></script>
  </head>
  <body>
    <div class="wrapper">
      <div id="header-container"></div>

      <main class="mypage-container">
        <!-- í”„ë¡œí•„ ì¹´ë“œ -->
        <section class="user-card">
          <h2>ğŸ‘¨â€ğŸ’¼ ì§ì› ì •ë³´</h2>
          <p><strong>ì´ë¦„:</strong> <span id="user-name">-</span></p>
          <p><strong>ì´ë©”ì¼:</strong> <span id="user-email">-</span></p>
          <p>
            <strong>ìµœê·¼ ë¡œê·¸ì¸:</strong> <span id="user-last-login">-</span>
          </p>
          <p>
            <span id="admin-badge" class="admin-badge" style="display: none">
              <i class="fas fa-crown"></i> ê´€ë¦¬ì
            </span>
          </p>
          <button id="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>

          <section
            id="admin-settings"
            class="admin-settings"
            style="display: none"
          >
            <h2>ğŸ› ï¸ ê´€ë¦¬ì ì„¤ì •</h2>
            <ul>
              <li>âœ”ï¸ ì‚¬ìš©ì ê³„ì • ê´€ë¦¬</li>
              <li>âœ”ï¸ ìƒí’ˆ ì´ˆê¸°í™” ë„êµ¬</li>
              <li>âœ”ï¸ ì‹œìŠ¤í…œ ë¡œê·¸ ë³´ê¸°</li>
            </ul>
          </section>
        </section>

        <!-- ğŸ”— ê³„ì • ì—°ë™ -->
        <section class="federation-card">
          <h2>ğŸ”— ê³„ì • ì—°ë™</h2>
          <p class="fed-help">
            ì´ë©”ì¼ ê³„ì •ì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ , ì†Œì…œ ê³„ì •ì€ ë¡œê·¸ì¸ìš©ìœ¼ë¡œ
            <strong>ì—°ë™</strong>í•  ìˆ˜ ìˆì–´ìš”.
          </p>

          <div class="link-list">
            <!-- Google -->
            <article class="link-item" data-provider="google">
              <div class="provider">
                <i class="fa-brands fa-google"></i>
                <div>
                  <h3>Google</h3>
                  <div class="status">
                    <span id="status-google" class="status-badge"
                      >í™•ì¸ ì¤‘â€¦</span
                    >
                  </div>
                </div>
              </div>
              <div class="actions">
                <button id="link-google" class="btn primary" type="button">
                  ì—°ë™í•˜ê¸°
                </button>
                <button
                  id="unlink-google"
                  class="btn danger hidden"
                  type="button"
                >
                  ì—°ë™ í•´ì§€
                </button>
              </div>
            </article>

            <!-- Kakao -->
            <article class="link-item" data-provider="kakao">
              <div class="provider">
                <i class="fa-solid fa-comment"></i>
                <div>
                  <h3>Kakao</h3>
                  <div class="status">
                    <span id="status-kakao" class="status-badge">í™•ì¸ ì¤‘â€¦</span>
                  </div>
                </div>
              </div>
              <div class="actions">
                <button id="link-kakao" class="btn primary" type="button">
                  ì—°ë™í•˜ê¸°
                </button>
                <button
                  id="unlink-kakao"
                  class="btn danger hidden"
                  type="button"
                >
                  ì—°ë™ í•´ì§€
                </button>
              </div>
            </article>

            <!-- Naver -->
            <article class="link-item" data-provider="naver">
              <div class="provider">
                <i class="fa-solid fa-n"></i>
                <div>
                  <h3>Naver</h3>
                  <div class="status">
                    <span id="status-naver" class="status-badge">í™•ì¸ ì¤‘â€¦</span>
                  </div>
                </div>
              </div>
              <div class="actions">
                <button id="link-naver" class="btn primary" type="button">
                  ì—°ë™í•˜ê¸°
                </button>
                <button
                  id="unlink-naver"
                  class="btn danger hidden"
                  type="button"
                >
                  ì—°ë™ í•´ì§€
                </button>
              </div>
            </article>
          </div>

          <p class="note">
            â€» ì—°ë™ í›„ì—ëŠ” í•´ë‹¹ ì†Œì…œ ë²„íŠ¼ìœ¼ë¡œë„ ë¡œê·¸ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—°ë™ì„
            í•´ì§€í•˜ë©´ ë¡œê·¸ì¸ì— ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
          </p>
        </section>
      </main>

      <div id="footer-container"></div>
    </div>

    <!-- header/footer ì‚½ì… & toast ì»¨í…Œì´ë„ˆ ë³´ì¥ -->
    <script type="module">
      import {
        loadHeader,
        loadFooter,
        showToast,
      } from "./js/components/comp.js";
      loadHeader("header-container");
      loadFooter("footer-container");
      if (!document.getElementById("toast")) {
        const el = document.createElement("div");
        el.id = "toast";
        document.body.appendChild(el);
      }
      // í•´ì‹œë¡œ ëŒì•„ì˜¨ ê²½ìš°(ì—°ë™ ì™„ë£Œ/ì‹¤íŒ¨) ì•ˆë‚´
      if (location.hash) {
        const p = new URLSearchParams(location.hash.slice(1));
        const err = p.get("error"),
          prov = p.get("provider"),
          tok = p.get("token");
        if (err === "not_linked")
          showToast(`í•´ë‹¹ ${prov} ê³„ì •ì€ ì—°ë™ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.`, true);
        if (tok && prov?.endsWith("_linked"))
          showToast(`${prov.replace("_linked", "")} ì—°ë™ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`);
        history.replaceState(null, "", location.pathname + location.search);
      }
    </script>
  </body>
</html>
